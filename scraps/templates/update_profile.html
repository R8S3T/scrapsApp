{% extends "layout.html" %}

{% block content %}
    <div class="container">
        <h1 class="page-title">{{ title }}</h1>
        <div class="form-container">
            <form id="update-profile-form" method="POST" action="{{ url_for('update_profile') }}" enctype="multipart/form-data">
                {{ form.hidden_tag() }}
                <div class="form-group">
                    {{ form.username.label(class="form-control-label") }}
                    {{ form.username(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.street.label(class="form-control-label") }}
                    {{ form.street(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.postcode.label(class="form-control-label") }}
                    {{ form.postcode(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.city.label(class="form-control-label") }}
                    {{ form.city(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.country.label(class="form-control-label") }}
                    {{ form.country(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.email.label(class="form-control-label") }}
                    {{ form.email(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.about_me.label(class="form-control-label") }}
                    {{ form.about_me(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.profile_picture.label(class="form-control-label") }}
                    {{ form.profile_picture(class="form-control-file") }}
                </div>
                <div class="form-group">
                    {{ scrap_form.scrap_picture.label(class="form-control-label") }}
                    {{ scrap_form.scrap_picture(class="form-control-file") }}
                </div>
                <div class="form-group">
                    {{ scrap_form.scrap_description.label(class="form-control-label") }}
                    {{ scrap_form.scrap_description(class="form-control") }}
                </div>
                <div class="wrapper">
                    <div class="box drop-area">
                        {% for item in items_data %}
                            <div id="scrap{{ loop.index }}" class="scrap" draggable="true">
                                {{ item }}
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="description-field" >Simply pick an item from the left box<br> and drop in one of the boxes below</div>
                <div class="items-wanted drop-area" id="items-wanted">
                    <h3>Items Wanted</h3>
                </div>
                <div class="items-for-trade drop-area" id="items-for-trade">
                    <h3>Items For Trade</h3>
                </div>
                <input type="submit" class="btn btn-primary" value="Update" onclick="event.preventDefault(); submitForm();">
                <input type="button" class="btn btn-secondary" value="Cancel" onclick="window.location.href='{{ url_for('profile') }}'">
                <input type="hidden" name="items_wanted_hidden" id="items_wanted_hidden" value="{{ form.items_wanted_hidden.data }}">
                <input type="hidden" name="items_for_trade_hidden" id="items_for_trade_hidden" value="{{ form.items_for_trade_hidden.data }}">
                <input type="hidden" name="items_data" id="items_data" value="{{ items_data|tojson|safe }}">
                </div>
            </form>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    <script>
        var allItems = {{ items_data|tojson }};
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            populateItems();
            document.querySelector('#update-profile-form').addEventListener('submit', function(event) {
                event.preventDefault();
                submitForm();
            });
        });
    </script>
{% endblock %} 
